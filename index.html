<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#050505">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>LifeOS Sovereign V72 - Bento Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap');
        
        :root {
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-bg: rgba(20, 20, 20, 0.6);
            --neon-blue: #3b82f6;
            --neon-purple: #8b5cf6;
        }

        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: #050505; 
            background-image: 
                radial-gradient(at 0% 0%, hsla(253,16%,7%,1) 0, transparent 50%), 
                radial-gradient(at 50% 0%, hsla(225,39%,15%,1) 0, transparent 50%), 
                radial-gradient(at 100% 0%, hsla(339,49%,15%,1) 0, transparent 50%); 
            color: #e5e5e5; 
            -webkit-font-smoothing: antialiased; 
            min-height: 100vh;
            padding-bottom: 80px; /* Space for mobile nav if needed */
        }

        /* --- UI COMPONENTS --- */
        .glass-panel { 
            background: var(--glass-bg); 
            backdrop-filter: blur(20px); 
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border); 
            border-radius: 1.5rem; 
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            transition: transform 0.2s ease, border-color 0.2s;
        }

        /* Bento Grid Layout helpers */
        .bento-grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 1rem;
        }
        @media (min-width: 768px) {
            .bento-grid { grid-template-columns: repeat(2, 1fr); }
            .bento-span-2 { grid-column: span 2; }
        }
        @media (min-width: 1024px) {
            .bento-grid { grid-template-columns: repeat(4, 1fr); }
            .bento-col-span-1 { grid-column: span 1; }
            .bento-col-span-2 { grid-column: span 2; }
            .bento-col-span-3 { grid-column: span 3; }
        }

        .bento-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 1.25rem;
            padding: 1.25rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
        }
        .bento-card:hover {
            background: rgba(255, 255, 255, 0.06);
            border-color: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
            box-shadow: 0 10px 40px -10px rgba(0,0,0,0.5);
        }

        /* Timeline Specifics */
        .timeline-container { position: relative; padding-left: 1.5rem; }
        .timeline-line-track { 
            position: absolute; left: 7px; top: 10px; bottom: 10px; width: 2px; 
            background: linear-gradient(to bottom, rgba(255,255,255,0.1), rgba(255,255,255,0.02)); 
        }
        .timeline-node {
            position: relative;
            margin-bottom: 1.5rem;
            padding-left: 1.5rem;
        }
        .timeline-dot {
            position: absolute; left: 0; top: 6px; width: 16px; height: 16px;
            border-radius: 50%; border: 3px solid #050505; z-index: 10;
        }
        
        /* Animations */
        @keyframes pop { 0% { transform: scale(1); } 50% { transform: scale(1.2); } 100% { transform: scale(1); } }
        .animate-pop { animation: pop 0.3s ease-out; }
        
        @keyframes fillUp { from { width: 0; } to { width: var(--target-width); } }
        
        /* Custom Elements */
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white; font-weight: 700; border-radius: 0.75rem;
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
            transition: 0.2s;
        }
        .btn-primary:active { transform: scale(0.96); }

        .day-pill {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 3.5rem; border-radius: 0.75rem;
            font-size: 0.75rem; cursor: pointer;
            background: rgba(255,255,255,0.03); border: 1px solid transparent;
            transition: 0.2s;
        }
        .day-pill.active {
            background: #fff; color: #000; font-weight: 800;
            box-shadow: 0 0 20px rgba(255,255,255,0.3);
        }
        .day-pill.has-event { border-bottom: 3px solid var(--neon-purple); }

        /* Onboarding Overlay */
        #onboarding { z-index: 999; background: #000; }
        .step-dots span { width: 8px; height: 8px; border-radius: 50%; background: #333; transition: 0.3s; }
        .step-dots span.active { background: #fff; width: 24px; border-radius: 4px; }
    </style>
</head>
<body class="p-4 md:p-6 lg:p-8 max-w-[1400px] mx-auto">

    <header class="flex justify-between items-center mb-8">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center font-bold text-white shadow-lg shadow-blue-900/40">L</div>
            <div>
                <h1 class="text-xl font-bold tracking-tight leading-none">Life<span class="text-blue-500 italic">OS</span></h1>
                <p class="text-[10px] text-zinc-500 font-bold uppercase tracking-widest">Sovereign V72</p>
            </div>
        </div>
        <div class="flex gap-4 items-center">
            <div class="hidden md:flex items-center gap-2 bg-white/5 px-3 py-1.5 rounded-full border border-white/5">
                <span class="text-orange-500 animate-pulse">üî•</span>
                <span id="streakCount" class="text-xs font-bold font-mono">0 Jours</span>
            </div>
            <button onclick="openProfile()" class="w-10 h-10 rounded-full bg-white/5 hover:bg-white/10 flex items-center justify-center border border-white/10 transition-colors">
                ‚öôÔ∏è
            </button>
        </div>
    </header>

    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
        
        <aside class="lg:col-span-4 space-y-6">
            
            <div class="glass-panel p-6">
                <div class="flex justify-between items-end mb-4">
                    <div>
                        <p class="text-xs text-zinc-500 font-bold uppercase">Aujourd'hui</p>
                        <h2 id="mainDateDisplay" class="text-3xl font-black text-white">Date</h2>
                    </div>
                    <div id="contextBadge" class="px-3 py-1 rounded-full bg-blue-500/20 border border-blue-500/30 text-blue-400 text-[10px] font-bold uppercase tracking-widest">
                        Standard
                    </div>
                </div>
                <div id="calendarScroll" class="grid grid-cols-7 gap-2 mb-2"></div>
            </div>

            <div class="glass-panel p-1 relative group">
                <textarea id="userInput" class="w-full bg-transparent p-5 text-sm font-medium text-white placeholder-zinc-600 outline-none resize-none h-28" placeholder="Qu'est-ce qu'on planifie ?&#10;Ex: 'Gym √† 18h', 'Dentiste demain 9h'"></textarea>
                <div class="flex justify-between items-center px-4 pb-4">
                    <span class="text-[10px] text-zinc-500 font-mono">IA READY</span>
                    <button onclick="traiterBatch()" class="btn-primary px-4 py-2 text-xs uppercase tracking-wider">Planifier</button>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div class="bento-card relative overflow-hidden group">
                    <div class="absolute inset-0 bg-blue-500/10 scale-y-0 group-hover:scale-y-100 transition-transform origin-bottom duration-500"></div>
                    <div class="flex justify-between items-start z-10">
                        <span class="text-2xl">üíß</span>
                        <span id="waterText" class="text-xl font-bold font-mono">0L</span>
                    </div>
                    <div class="z-10 mt-4">
                        <div class="h-1.5 w-full bg-white/10 rounded-full overflow-hidden mb-2">
                            <div id="waterBar" class="h-full bg-blue-500 transition-all duration-700 w-0"></div>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="addWater(0.25)" class="flex-1 bg-white/5 hover:bg-white/20 py-1.5 rounded text-[9px] font-bold uppercase text-center transition">+25cl</button>
                        </div>
                    </div>
                </div>

                <div class="bento-card">
                    <div class="flex justify-between items-start">
                        <span class="text-2xl">üî•</span>
                        <div class="text-right">
                            <span id="calCurrent" class="text-xl font-bold font-mono block">0</span>
                            <span id="calTarget" class="text-[10px] text-zinc-500 font-mono">/ 2500 kcal</span>
                        </div>
                    </div>
                    <div class="mt-auto pt-2">
                        <p id="tdeeLabel" class="text-[10px] text-zinc-400">Cible Maintenance</p>
                    </div>
                </div>
            </div>
            
            <div id="sonicTrigger" onclick="playContextMusic()" class="glass-panel p-4 flex items-center justify-between cursor-pointer hover:bg-white/5 transition group">
                <div class="flex items-center gap-3">
                    <div id="musicIconBg" class="w-10 h-10 rounded-full bg-purple-500/20 flex items-center justify-center text-purple-400 group-hover:scale-110 transition">üéµ</div>
                    <div>
                        <p class="text-[9px] font-bold uppercase text-zinc-500">Ambiance Actuelle</p>
                        <p id="sonicLabel" class="text-sm font-bold truncate max-w-[150px]">Deep Focus</p>
                    </div>
                </div>
                <div class="w-8 h-8 rounded-full border border-white/10 flex items-center justify-center text-[10px]">‚ñ∂</div>
            </div>

        </aside>

        <main class="lg:col-span-8 space-y-6">
            
            <div id="alertsArea" class="space-y-4"></div>

            <div class="glass-panel p-6 md:p-8 min-h-[500px]">
                <div class="flex justify-between items-center mb-8 border-b border-white/5 pb-4">
                    <h3 class="text-lg font-bold">Flux Chronologique</h3>
                    <div class="flex gap-2">
                        <span class="w-2 h-2 rounded-full bg-yellow-500"></span>
                        <span class="w-2 h-2 rounded-full bg-blue-500"></span>
                        <span class="w-2 h-2 rounded-full bg-green-500"></span>
                    </div>
                </div>
                
                <div id="masterTimeline" class="timeline-container">
                    </div>
            </div>
        </main>
    </div>

    <div id="onboardingModal" class="fixed inset-0 z-[100] flex items-center justify-center bg-black hidden">
        <div class="w-full max-w-md p-8 text-center space-y-8 animate-pop">
            <div class="w-20 h-20 bg-gradient-to-tr from-blue-600 to-purple-600 rounded-3xl mx-auto flex items-center justify-center text-4xl shadow-2xl shadow-blue-900/50">üöÄ</div>
            
            <div id="step1" class="step-content">
                <h1 class="text-3xl font-black mb-2">Bienvenue sur LifeOS</h1>
                <p class="text-zinc-400">L'agenda qui g√®re votre temps, votre √©nergie et votre biologie. Configurons votre syst√®me.</p>
                <button onclick="nextStep(2)" class="btn-primary w-full py-4 mt-8">Commencer</button>
            </div>

            <div id="step2" class="step-content hidden">
                <h2 class="text-2xl font-bold mb-6">Donn√©es Biom√©triques</h2>
                <p class="text-sm text-zinc-500 mb-4">Pour calculer vos besoins (TDEE) et votre eau.</p>
                <div class="space-y-3">
                    <input type="text" id="setupName" placeholder="Votre Pr√©nom" class="w-full bg-white/5 border border-white/10 rounded-xl p-4 text-center outline-none focus:border-blue-500">
                    <div class="flex gap-3">
                        <input type="number" id="setupWeight" placeholder="Poids (kg)" class="w-1/2 bg-white/5 border border-white/10 rounded-xl p-4 text-center outline-none">
                        <input type="number" id="setupHeight" placeholder="Taille (cm)" class="w-1/2 bg-white/5 border border-white/10 rounded-xl p-4 text-center outline-none">
                    </div>
                </div>
                <button onclick="finishOnboarding()" class="btn-primary w-full py-4 mt-8">Terminer & Lancer</button>
            </div>

            <div class="flex justify-center gap-2 mt-8 step-dots">
                <span id="dot1" class="active"></span>
                <span id="dot2"></span>
            </div>
        </div>
    </div>

    <div id="taskModal" class="hidden fixed inset-0 z-[200] flex items-end md:items-center justify-center bg-black/80 backdrop-blur-sm">
        <div class="glass-panel p-6 w-full max-w-lg m-4 rounded-3xl border-t border-white/10 shadow-2xl relative">
            <button onclick="closeTaskModal()" class="absolute top-4 right-4 text-zinc-500 hover:text-white bg-white/5 w-8 h-8 rounded-full">‚úï</button>
            <h2 class="text-xl font-bold mb-6">√âditer</h2>
            <div class="space-y-4">
                <input type="time" id="modalTime" class="w-full bg-black/30 p-4 rounded-xl text-white text-xl outline-none border border-white/10 focus:border-blue-500">
                <input type="text" id="modalShort" class="w-full bg-black/30 p-4 rounded-xl text-white font-bold outline-none border border-white/10 focus:border-blue-500">
                <div class="flex gap-3 mt-6">
                    <button onclick="saveTaskModal()" class="flex-1 btn-primary py-3">Sauvegarder</button>
                    <button onclick="deleteTaskModal()" class="px-4 py-3 rounded-xl bg-red-500/10 text-red-500 hover:bg-red-500 hover:text-white transition">Supprimer</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- CORE DATA & CONFIG ---
        let db = JSON.parse(localStorage.getItem('lifeos_v72_db') || "{}");
        let profile = JSON.parse(localStorage.getItem('lifeos_v72_profile') || "null"); // Null triggers onboarding
        let health = JSON.parse(localStorage.getItem('lifeos_v72_health') || '{"water":0, "streak":0, "lastActive":null}');
        
        const now = new Date();
        let selectedDay = now.getDate();
        const monthNames = ["Janvier", "F√©vrier", "Mars", "Avril", "Mai", "Juin", "Juillet", "Ao√ªt", "Septembre", "Octobre", "Novembre", "D√©cembre"];
        
        // --- DATASETS (Compact for performance) ---
        const CONTEXTS = {
            sport: { label: "Athl√®te", color: "orange", icon: "‚ö°", music: ["Phonk Workout", "Gym HipHop"] },
            focus: { label: "Deep Work", color: "purple", icon: "üß†", music: ["Lofi Girl", "Hans Zimmer"] },
            chill: { label: "R√©cup√©ration", color: "green", icon: "üåø", music: ["Jazz Vibes", "Nature Sounds"] }
        };
        const MEALS = {
            sport: ["Riz Dinde (Post-Workout)", "P√¢tes Bolognaise", "Omelette Pomme de Terre"],
            focus: ["Saumon Quinoa (Omega 3)", "Salade C√©sar", "Wok L√©gumes Tofu"],
            chill: ["Soupe Maison", "Avocado Toast", "Filet Mignon Haricots"]
        };

        // --- INIT ---
        window.onload = function() {
            if (!profile) {
                document.getElementById('onboardingModal').classList.remove('hidden');
            } else {
                checkDailyReset();
                renderApp();
            }
        };

        function checkDailyReset() {
            const todayStr = now.toDateString();
            if (health.lastActive !== todayStr) {
                health.water = 0;
                health.lastActive = todayStr;
                saveData();
            }
        }

        // --- ONBOARDING LOGIC ---
        function nextStep(n) {
            document.querySelectorAll('.step-content').forEach(el => el.classList.add('hidden'));
            document.getElementById('step'+n).classList.remove('hidden');
            document.querySelectorAll('.step-dots span').forEach(el => el.classList.remove('active'));
            document.getElementById('dot'+n).classList.add('active');
        }

        function finishOnboarding() {
            const w = document.getElementById('setupWeight').value || 70;
            const h = document.getElementById('setupHeight').value || 175;
            const n = document.getElementById('setupName').value || "Utilisateur";
            
            profile = { name: n, weight: w, height: h, goal: 'focus' };
            localStorage.setItem('lifeos_v72_profile', JSON.stringify(profile));
            document.getElementById('onboardingModal').classList.add('hidden');
            renderApp();
        }

        // --- MAIN RENDER LOOP ---
        function renderApp() {
            renderCalendar();
            renderStats();
            renderTimeline();
        }

        function renderCalendar() {
            const c = document.getElementById('calendarScroll');
            c.innerHTML = '';
            document.getElementById('mainDateDisplay').innerText = `${selectedDay} ${monthNames[now.getMonth()]}`;
            
            const daysInMonth = new Date(now.getFullYear(), now.getMonth()+1, 0).getDate();
            
            // Render logic optimized for Bento Grid
            // Show range surrounding selected day
            let start = Math.max(1, selectedDay - 3);
            let end = Math.min(daysInMonth, start + 6);
            if(end - start < 6) start = Math.max(1, end - 6);

            for(let i = start; i <= end; i++) {
                const isSel = (i === selectedDay);
                const hasTask = db[i] && db[i].length > 0;
                const d = document.createElement('div');
                d.className = `day-pill ${isSel ? 'active' : ''} ${hasTask ? 'has-event' : ''}`;
                d.innerHTML = `<span class="opacity-50 text-[10px]">${i === now.getDate() ? 'AUJ' : 'J'+i}</span><span class="font-bold">${i}</span>`;
                d.onclick = () => { selectedDay = i; renderApp(); };
                c.appendChild(d);
            }
        }

        function determineContext(tasks) {
            const txt = tasks.map(t => t.text.toLowerCase()).join(' ');
            if (txt.match(/sport|gym|crossfit|foot|courir/)) return 'sport';
            if (txt.match(/repos|famille|dimanche/)) return 'chill';
            return 'focus'; // Default
        }

        function renderStats() {
            // TDEE Calc
            const tasks = db[selectedDay] || [];
            const ctx = determineContext(tasks);
            const style = CONTEXTS[ctx];
            
            // Badge UI
            const badge = document.getElementById('contextBadge');
            badge.className = `px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-widest border bg-${style.color}-500/10 border-${style.color}-500/20 text-${style.color}-400`;
            badge.innerText = `${style.icon} ${style.label}`;

            // Music
            document.getElementById('sonicLabel').innerText = style.music[selectedDay % style.music.length];
            document.getElementById('musicIconBg').className = `w-10 h-10 rounded-full flex items-center justify-center bg-${style.color}-500/20 text-${style.color}-400`;

            // Calories & Water
            let bmr = (10 * profile.weight) + (6.25 * profile.height) - (5 * 25) + 5; // Simplified BMR
            let mult = ctx === 'sport' ? 1.6 : 1.3;
            let target = Math.round(bmr * mult);
            document.getElementById('calTarget').innerText = `/ ${target} kcal`;
            document.getElementById('waterText').innerText = `${health.water}L`;
            
            // Water bar animation
            let wTarget = (profile.weight * 0.035).toFixed(1);
            let pct = Math.min(100, (health.water / wTarget) * 100);
            document.getElementById('waterBar').style.width = `${pct}%`;
            
            // Streak
            document.getElementById('streakCount').innerText = `${health.streak || 0} Jours`;
        }

        function renderTimeline() {
            const container = document.getElementById('masterTimeline');
            container.innerHTML = '';
            
            const tasks = db[selectedDay] || [];
            const ctx = determineContext(tasks);
            
            // Generate standard meal/routine items
            let items = [];
            
            // Lunch
            items.push({
                type: 'meal', time: '12:30', 
                text: MEALS[ctx][selectedDay % 3], 
                sub: 'Nutrition Optimis√©e'
            });
            
            // Tasks
            tasks.forEach((t, idx) => {
                items.push({
                    type: 'task', time: t.time, 
                    text: t.short, full: t.text, 
                    id: idx, done: t.done 
                });
            });
            
            // Sort by time
            items.sort((a,b) => parseInt(a.time.replace(':','')) - parseInt(b.time.replace(':','')));

            // Render HTML
            items.forEach(item => {
                let content = '';
                let dotColor = '#3b82f6'; // default blue
                
                if (item.type === 'meal') {
                    dotColor = '#10b981';
                    content = `
                    <div class="bento-card p-3 flex-row items-center gap-4 bg-green-500/5 border-green-500/10">
                        <div class="text-2xl">ü•ó</div>
                        <div>
                            <p class="font-bold text-sm">${item.text}</p>
                            <p class="text-[10px] text-zinc-500 uppercase tracking-wider">${item.sub}</p>
                        </div>
                    </div>`;
                } else {
                    // Task
                    const isDone = item.done;
                    if(item.text.toLowerCase().includes('sport')) dotColor = '#f97316';
                    
                    content = `
                    <div class="bento-card p-3 flex-row items-center gap-3 group hover:bg-white/10 cursor-pointer ${isDone ? 'opacity-40 grayscale' : ''}" onclick="openTaskEdit(${item.id})">
                        <div onclick="toggleTask(event, ${item.id})" class="w-5 h-5 rounded border ${isDone ? 'bg-blue-500 border-blue-500' : 'border-white/30'} flex items-center justify-center transition-colors">
                            ${isDone ? '‚úì' : ''}
                        </div>
                        <div class="flex-1">
                            <p class="font-bold text-sm ${isDone ? 'line-through' : ''}">${item.text}</p>
                        </div>
                    </div>`;
                }

                container.innerHTML += `
                <div class="timeline-node">
                    <div class="timeline-dot" style="background:${dotColor}; box-shadow: 0 0 10px ${dotColor}"></div>
                    <div class="text-[10px] font-mono opacity-50 mb-1 absolute -left-12 top-1 text-right w-8">${item.time}</div>
                    ${content}
                </div>`;
            });
            
            if(items.length === 0) {
                container.innerHTML = `<div class="text-center py-10 opacity-30 italic">Rien de pr√©vu. Profitez du calme.</div>`;
            }
        }

        // --- ACTIONS ---
        function traiterBatch() {
            const raw = document.getElementById('userInput').value;
            if(!raw.trim()) return;
            
            // Simple Parsing Logic
            // In a real app, this would use regex to find time like "18h"
            const lines = raw.split('\n');
            if(!db[selectedDay]) db[selectedDay] = [];
            
            lines.forEach(l => {
                if(l.length < 2) return;
                // Detect Time
                const timeMatch = l.match(/(\d{1,2})[h:](\d{2})?/);
                let time = "09:00";
                let text = l;
                
                if(timeMatch) {
                    let h = timeMatch[1].padStart(2,'0');
                    let m = timeMatch[2] || "00";
                    time = `${h}:${m}`;
                    text = l.replace(timeMatch[0], '').trim(); // Remove time from text
                }
                
                db[selectedDay].push({ text: l, short: text, time: time, done: false });
            });
            
            saveData();
            document.getElementById('userInput').value = '';
            renderApp();
        }

        function toggleTask(e, id) {
            e.stopPropagation();
            db[selectedDay][id].done = !db[selectedDay][id].done;
            
            // Gamification: Increase streak if all tasks done
            const allDone = db[selectedDay].every(t => t.done);
            if(allDone && db[selectedDay].length > 0) {
                health.streak++;
                alert("üî• S√âRIE PROLONG√âE ! +1"); // Simple feedback
            }
            
            saveData();
            renderApp();
        }

        function addWater(amount) {
            health.water = Math.round((health.water + amount) * 100) / 100;
            saveData();
            renderStats(); // Only re-render stats for performance
            
            // Micro-interaction
            document.getElementById('waterText').classList.add('animate-pop');
            setTimeout(() => document.getElementById('waterText').classList.remove('animate-pop'), 300);
        }

        function saveData() {
            localStorage.setItem('lifeos_v72_db', JSON.stringify(db));
            localStorage.setItem('lifeos_v72_health', JSON.stringify(health));
        }

        // --- EDIT MODAL HELPERS ---
        let editId = null;
        function openTaskEdit(id) {
            editId = id;
            const t = db[selectedDay][id];
            document.getElementById('modalTime').value = t.time;
            document.getElementById('modalShort').value = t.short;
            document.getElementById('taskModal').classList.remove('hidden');
        }
        function closeTaskModal() { document.getElementById('taskModal').classList.add('hidden'); }
        function saveTaskModal() {
            if(editId === null) return;
            db[selectedDay][editId].time = document.getElementById('modalTime').value;
            db[selectedDay][editId].short = document.getElementById('modalShort').value;
            saveData(); closeTaskModal(); renderApp();
        }
        function deleteTaskModal() {
            if(editId === null) return;
            db[selectedDay].splice(editId, 1);
            saveData(); closeTaskModal(); renderApp();
        }
        function playContextMusic() {
            const q = document.getElementById('sonicLabel').innerText;
            window.open(`https://www.youtube.com/results?search_query=${encodeURIComponent(q)}`, '_blank');
        }
        function openProfile() {
            if(confirm("R√©initialiser le profil et l'onboarding ?")) {
                localStorage.clear();
                location.reload();
            }
        }
    </script>
</body>
</html>
