<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LifeOS Sovereign V46 - Intellectual Expansion</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #050505; background-image: radial-gradient(at 0% 0%, hsla(253,16%,7%,1) 0, transparent 50%), radial-gradient(at 50% 0%, hsla(225,39%,30%,1) 0, transparent 50%), radial-gradient(at 100% 0%, hsla(339,49%,30%,1) 0, transparent 50%); color: #fff; -webkit-font-smoothing: antialiased; min-height: 100vh; }
        .glass-base { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(40px); border: 1px solid rgba(255, 255, 255, 0.05); box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); border-radius: 2rem; }
        .glass-card { background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.03); border-radius: 1.5rem; transition: all 0.3s ease; }
        
        /* KNOWLEDGE CARD SPECIAL STYLE */
        .knowledge-card { background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%); border: 1px solid rgba(59, 130, 246, 0.3); }
        
        .timeline-item { position: relative; padding-left: 2rem; border-left: 2px solid rgba(255,255,255,0.1); padding-bottom: 1.5rem; }
        .timeline-dot { position: absolute; left: -0.4rem; top: 0; width: 0.8rem; height: 0.8rem; border-radius: 50%; background: #3b82f6; }
        .timeline-time { font-family: monospace; font-size: 0.75rem; opacity: 0.6; }
        .primary-btn { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); transition: 0.3s; }
        .video-btn { background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.1); color: white; font-size: 0.65rem; font-weight: 800; padding: 6px 12px; border-radius: 8px; cursor: pointer; }
        .day { aspect-ratio: 1; border-radius: 0.8rem; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; cursor: pointer; transition: 0.2s; background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.05); }
        .day-today { color: #60a5fa; font-weight: 800; border-color: #60a5fa; }
        .day-selected { background: white !important; color: black !important; font-weight: 900; }
        .has-event { border-bottom: 2px solid #a855f7; }
        .water-progress { transition: width 1s ease; background: linear-gradient(90deg, #3b82f6, #60a5fa); }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-[1700px] mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8">
        
        <aside class="lg:col-span-3 flex flex-col gap-6 h-[calc(100vh-4rem)] sticky top-8">
            <div class="glass-base p-8 space-y-6 flex-1 flex flex-col">
                <div class="flex justify-between items-center"><h1 class="text-2xl font-bold tracking-tight">Life<span class="text-blue-500 italic">OS</span></h1><button onclick="openProfile()" class="text-[10px] font-bold bg-white/10 px-3 py-1.5 rounded-full hover:bg-white/20">‚öôÔ∏è PROFIL</button></div>
                <div><p class="text-[9px] font-bold uppercase tracking-widest text-zinc-500 mb-2">Calendrier</p><div id="calendar" class="grid grid-cols-7 gap-1"></div></div>
                <div class="flex-1"><p class="text-[9px] font-bold uppercase tracking-widest text-zinc-500 mb-2">Ajout Rapide</p><textarea id="userInput" class="w-full bg-black/20 border border-white/5 rounded-2xl p-4 text-sm outline-none resize-none h-32" placeholder="Ex: 'R√©union √† 10h'"></textarea><button onclick="traiter()" class="primary-btn w-full mt-3 py-3 rounded-xl text-[10px] font-black uppercase">Planifier</button></div>
                <div class="pt-6 border-t border-white/5"><div class="flex justify-between items-end mb-2"><span class="text-[10px] font-bold uppercase text-blue-400">Eau</span><div><span id="waterText" class="text-2xl font-black">0L</span><span id="waterTarget" class="text-xs opacity-50">/ 2.5L</span></div></div><div class="h-2 w-full bg-black/40 rounded-full overflow-hidden mb-3"><div id="waterBar" class="water-progress h-full w-0"></div></div><div class="grid grid-cols-2 gap-2"><button onclick="addWater(0.25)" class="py-2 bg-white/5 rounded-lg text-[10px] font-bold hover:bg-blue-500/20">+ Verre</button><button onclick="addWater(0.5)" class="py-2 bg-white/5 rounded-lg text-[10px] font-bold hover:bg-blue-500/20">+ Gourde</button></div></div>
            </div>
        </aside>

        <main class="lg:col-span-9 space-y-6 pb-10">
            <div id="main-hud" class="glass-base p-8 md:p-10">
                
                <div class="flex flex-col md:flex-row justify-between md:items-end mb-6 pb-6 border-b border-white/5 gap-6">
                    <div>
                        <h2 id="hudDate" class="text-4xl md:text-6xl font-black italic tracking-tight text-white">Date</h2>
                        <div id="contextBanner" class="mt-4 flex items-center gap-3"><span class="text-3xl">‚öñÔ∏è</span><div><p class="text-lg font-bold text-blue-400" id="contextTitle">Standard</p><p class="text-xs opacity-50" id="contextSubtitle">√âquilibre</p></div></div>
                    </div>
                    <div class="flex gap-8 text-right h-fit"><div><p class="text-[9px] font-bold uppercase text-zinc-500 mb-1">Objectif</p><p id="calTarget" class="text-2xl font-mono font-medium">--</p></div></div>
                </div>

                <div id="knowledgeHub" class="hidden glass-card knowledge-card p-6 mb-8 flex flex-col md:flex-row items-center gap-6">
                    <div class="w-16 h-16 rounded-2xl bg-blue-500/20 flex items-center justify-center text-3xl">üìö</div>
                    <div class="flex-1 text-center md:text-left">
                        <p class="text-[10px] font-black uppercase text-blue-400 mb-1">Opportunit√© de Croissance</p>
                        <p class="text-lg font-bold">Journ√©e calme. On s'instruit ?</p>
                        <p class="text-xs opacity-60">Utilisez ce temps pour votre √©ducation financi√®re ou culturelle.</p>
                    </div>
                    <div class="flex flex-col gap-2 w-full md:w-auto">
                        <button onclick="learn('finance')" class="video-btn bg-blue-600 hover:bg-white hover:text-black transition-colors">‚ñ∂ Finance (Finary/Louvet)</button>
                        <button onclick="learn('culture')" class="video-btn hover:bg-white hover:text-black">‚ñ∂ Culture & Histoire</button>
                    </div>
                </div>

                <div class="space-y-6">
                    <div class="glass-card p-6 flex items-center justify-between border-l-2 border-yellow-500"><div class="flex items-center gap-6 text-xl">‚òÄÔ∏è<div><p class="text-[10px] font-bold uppercase text-yellow-500">Matin</p><p id="hudRoutineM" class="text-lg font-medium">--</p></div></div><button id="btnRoutineM" class="video-btn">‚ñ∂ Vid√©o</button></div>

                    <div class="glass-card p-6 flex flex-col relative overflow-hidden">
                        <div id="lunchColorBar" class="absolute left-0 top-0 bottom-0 w-1 bg-blue-500"></div>
                        <div class="pl-4"><p id="hudLunch" class="text-xl font-bold">--</p><p id="lunchVits" class="text-[10px] text-zinc-400 mt-2 font-mono">--</p></div>
                    </div>

                    <div class="glass-card p-6"><p class="text-xs font-bold uppercase opacity-40 mb-6">Agenda Chronologique</p><div id="hudTasks" class="space-y-0 pl-2"></div></div>

                    <div class="glass-card p-6 flex flex-col relative overflow-hidden">
                        <div id="dinnerColorBar" class="absolute left-0 top-0 bottom-0 w-1 bg-purple-500"></div>
                        <div class="pl-4"><p id="hudDinner" class="text-xl font-bold">--</p><p id="dinnerVits" class="text-[10px] text-zinc-400 mt-2 font-mono">--</p></div>
                    </div>

                    <div class="glass-card p-6 flex items-center justify-between border-l-2 border-indigo-500"><div class="flex items-center gap-6 text-xl">üåô<div><p class="text-[10px] font-bold uppercase text-indigo-500">Soir</p><p id="hudRoutineE" class="text-lg font-medium">--</p></div></div><button id="btnRoutineE" class="video-btn">‚ñ∂ Vid√©o</button></div>
                </div>
            </div>
        </main>
    </div>

    <div id="profileModal" class="hidden fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-md"><div class="glass-base p-8 max-w-sm w-full rounded-[2rem]"><h2 class="text-xl font-bold mb-6 text-center">Profil</h2><div class="space-y-3 mb-6"><input type="number" id="inputWeight" class="w-full bg-black/20 p-4 rounded-xl text-center text-white outline-none border border-white/10" placeholder="Poids (kg)"><input type="number" id="inputHeight" class="w-full bg-black/20 p-4 rounded-xl text-center text-white outline-none border border-white/10" placeholder="Taille (cm)"><input type="number" id="inputAge" class="w-full bg-black/20 p-4 rounded-xl text-center text-white outline-none border border-white/10" placeholder="√Çge"><select id="inputSex" class="w-full bg-black/20 p-4 rounded-xl text-center text-white border border-white/10"><option value="male" class="text-black">Homme</option><option value="female" class="text-black">Femme</option></select></div><button onclick="saveProfile()" class="primary-btn w-full py-4 rounded-xl font-bold uppercase text-xs">Sauvegarder</button></div></div>

    <script>
        let db = JSON.parse(localStorage.getItem('lifeos_v46_db') || "{}");
        let profile = JSON.parse(localStorage.getItem('lifeos_v46_profile') || '{"weight":80, "height":180, "age":30, "sex":"male"}');
        let health = JSON.parse(localStorage.getItem('lifeos_v46_health') || '{"water":0}');
        const now = new Date(); const todayNum = now.getDate(); let selectedDay = todayNum;

        // --- DATABASE REPAS (EXTRAIT) ---
        const M_SPORT_L = ["P√¢tes Bolo Maison", "Riz + Steak Hach√©", "Wrap Poulet"];
        const M_SPORT_D = ["Omelette Patates", "Cabillaud Pur√©e", "Bowl Quinoa"];
        const M_FOCUS_L = ["Saumon Quinoa", "Salade C√©sar", "Bowl Tofu"];
        const M_FOCUS_D = ["Soupe L√©gumes", "Dinde Haricots", "Wok Cajou"];

        function renderHUD() {
            const isToday = (selectedDay === todayNum);
            document.getElementById('hudDate').innerText = `${selectedDay} ${["Jan.", "F√©v.", "Mar.", "Avr.", "Mai", "Juin", "Juil.", "Ao√ªt", "Sept.", "Oct.", "Nov.", "D√©c."][now.getMonth()]}`;

            const tasks = db[selectedDay] || [];
            const txt = tasks.map(t => t.text.toLowerCase()).join(' ');
            
            // LOGIQUE KNOWLEDGE HUB : Si journ√©e calme (moins de 3 t√¢ches)
            const kHub = document.getElementById('knowledgeHub');
            if (tasks.length <= 2) { kHub.classList.remove('hidden'); } else { kHub.classList.add('hidden'); }

            let mode = 'diet'; if (txt.includes('sport')) mode = 'sport'; else if (txt.includes('r√©union') || txt.includes('bureau')) mode = 'focus';

            // REPAS & VITS (Rotation simplifi√©e ici)
            const rot = (selectedDay - 1) % 3;
            const l = mode==='sport'?M_SPORT_L[rot]:M_FOCUS_L[rot];
            const d = mode==='sport'?M_SPORT_D[rot]:M_FOCUS_D[rot];
            
            document.getElementById('hudLunch').innerText = l;
            document.getElementById('lunchVits').innerText = `‚ú® Apport : Vit. D, B12, Magn√©sium`;
            document.getElementById('hudDinner').innerText = d;
            document.getElementById('dinnerVits').innerText = `‚ú® Apport : Omega-3, Fer, Zinc`;

            // ROUTINES
            const routines = { sport: { m: "Mobilit√© Articulaire", e: "Automassage" }, focus: { m: "M√©ditation Focus", e: "Lecture papier" }, diet: { m: "Yoga Flow", e: "Respiration" } };
            document.getElementById('hudRoutineM').innerText = routines[mode].m;
            document.getElementById('hudRoutineE').innerText = routines[mode].e;

            // TIMELINE
            const tBox = document.getElementById('hudTasks');
            tBox.innerHTML = tasks.length ? tasks.sort((a,b) => (a.text.match(/\d+h/)||["23h"])[0].localeCompare((b.text.match(/\d+h/)||["23h"])[0])).map((t, i) => {
                const time = (t.text.match(/(\d{1,2}h\d{0,2})/) || ["‚Ä¢"])[0];
                return `<div class="timeline-item"><div class="timeline-dot"></div><div class="timeline-time">${time}</div><div class="glass-card p-3 flex items-center gap-3 group"><input type="checkbox" ${t.done?'checked':''} onchange="toggleTask(${selectedDay}, ${tasks.indexOf(t)})" class="w-4 h-4 accent-blue-500"><span class="${t.done?'line-through opacity-30':'font-medium text-sm'}">${t.text}</span></div></div>`;
            }).join('') : `<p class="text-sm opacity-30 italic text-center p-4">Agenda libre.</p>`;

            // CALORIES
            let bmr = (10*profile.weight) + (6.25*profile.height) - (5*profile.age) + (profile.sex==='male'?5:-161);
            document.getElementById('calTarget').innerText = `${Math.round(bmr*(mode==='sport'?1.7:1.3))} kcal`;
            
            updateWaterUI(mode);
        }

        // NEW: FUNCTION TO LEARN
        function learn(topic) {
            let q = "";
            if (topic === 'finance') q = "Mathieu Louvet Mathieu Baccino Finary bourse investissement √©ducation financi√®re";
            else q = "Documentaire histoire du monde culture g√©n√©rale Nota Bene Arte";
            window.open(`https://www.youtube.com/results?search_query=${encodeURIComponent(q)}`, '_blank');
        }

        // --- HELPERS ---
        function addWater(n) { health.water += n; save(); }
        function updateWaterUI(m) { let t = (profile.weight*0.03)+(m==='sport'?1:0); t=Math.round(t*10)/10; document.getElementById('waterText').innerText = `${health.water}L`; document.getElementById('waterBar').style.width = `${Math.min(100, (health.water/t)*100)}%`; }
        function renderCal() { const c = document.getElementById('calendar'); c.innerHTML=''; const m = new Date(now.getFullYear(), now.getMonth()+1, 0).getDate(); for(let i=1; i<=m; i++) { const d = document.createElement('div'); let cls="day"; if(i===todayNum)cls+=" day-today"; if(i===selectedDay)cls+=" day-selected"; if(db[i]&&db[i].length)cls+=" has-event"; d.className=cls; d.innerText=i; d.onclick=()=>{selectedDay=i; renderCal(); renderHUD();}; c.appendChild(d); } }
        function traiter() { const r = document.getElementById('userInput').value; if(!r.trim())return; db[selectedDay]=[...(db[selectedDay]||[]),{text:r,done:false}]; save(); document.getElementById('userInput').value=''; renderHUD(); }
        function toggleTask(d,i){db[d][i].done=!db[d][i].done; save();}
        function save(){localStorage.setItem('lifeos_v46_db',JSON.stringify(db)); localStorage.setItem('lifeos_v46_profile',JSON.stringify(profile)); localStorage.setItem('lifeos_v46_health',JSON.stringify(health)); renderCal(); renderHUD();}
        function openProfile(){document.getElementById('profileModal').classList.remove('hidden');}
        function saveProfile(){profile.weight=document.getElementById('inputWeight').value||80; profile.height=document.getElementById('inputHeight').value||180; profile.age=document.getElementById('inputAge').value||30; profile.sex=document.getElementById('inputSex').value; document.getElementById('profileModal').classList.add('hidden'); save();}
        renderCal(); renderHUD();
    </script>
</body>
</html>
